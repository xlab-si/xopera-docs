<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>xOpera CLI (opera) &mdash; xOpera  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="_static/xlab-favicon-16x16.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="xOpera API" href="03-api.html" />
    <link rel="prev" title="Introduction" href="01-intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> xOpera
            <img src="_static/xopera-mark-black-mid.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01-intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">xOpera CLI (opera)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cli-commands-reference">CLI commands reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deploy">deploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#undeploy">undeploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validate">validate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs">outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#info">info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package">package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unpackage">unpackage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diff">diff</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update">update</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notify">notify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#secrets-and-environment-variables">Secrets and Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shell-completion">Shell completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="03-api.html">xOpera API</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-saas.html">xOpera SaaS</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-tps.html">xOpera TPS (Template Library)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-scanner.html">IaC Scanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="08-contact.html">Get in touch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/xlab-si/xopera-opera">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xOpera</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>xOpera CLI (opera)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/02-cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="xopera-cli-opera">
<span id="id1"></span><h1>xOpera CLI (opera)<a class="headerlink" href="#xopera-cli-opera" title="Permalink to this headline"></a></h1>
<div class="figure align-center" id="xopera-cli-logo">
<a class="reference external image-reference" href="_images/xopera-cli-mark-black-text-mid.png"><img alt="_images/xopera-cli-mark-black-text-mid.png" src="_images/xopera-cli-mark-black-text-mid.png" style="width: 40%;" /></a>
</div>
<div class="section" id="installation">
<span id="cli-installation"></span><h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h2>
<p>This section explains the installation of xOpera orchestrator.</p>
<p><strong>Prerequisites</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">opera</span></code> requires python 3 and a virtual environment.
In a typical modern Linux environment, we should already be set.
In Ubuntu, however, we might need to run the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo apt update
<span class="gp">$ </span>sudo apt install -y python3-venv python3-wheel python-wheel-common
</pre></div>
</div>
<p><strong>Installation</strong></p>
<p>xOpera is distributed as Python package that is regularly published on <a class="reference external" href="https://pypi.org/project/opera/">PyPI</a>.
So the simplest way to test <code class="docutils literal notranslate"><span class="pre">opera</span></code> is to install it into virtual environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir ~/opera <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/opera
<span class="gp">$ </span>python3 -m venv .venv <span class="o">&amp;&amp;</span> . .venv/bin/activate
<span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span>pip install --upgrade pip
<span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span>pip install opera
</pre></div>
</div>
<p>The development version of the package is available on <a class="reference external" href="https://test.pypi.org/project/opera/">Test PyPI</a> and the installation goes as follows.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span>pip install --index-url https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/ opera
</pre></div>
</div>
</div>
<div class="section" id="quickstart">
<span id="cli-quickstart"></span><h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline"></a></h2>
<p>After you <a class="reference external" href="CLIinstallation">installed xOpera CLI</a> into virtual environment you can test if everything is working
as expected.
We can now explain how to deploy the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/hello-world">hello-world</a> example.</p>
<p>The hello world TOSCA service template is below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tosca_definitions_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_simple_yaml_1_3</span><span class="w"></span>

<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello-world&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_author</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;XLAB&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="w"></span>

<span class="nt">node_types</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">hello_type</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.SoftwareComponent</span><span class="w"></span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">Standard</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">marker</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> get_input</span><span class="p">:</span><span class="w"> </span><span class="nv">marker</span><span class="w"> </span><span class="p p-Indicator">}</span><span class="w"></span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">create</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">playbooks/create.yaml</span><span class="w"></span>
<span class="w">          </span><span class="nt">delete</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">playbooks/delete.yaml</span><span class="w"></span>

<span class="nt">topology_template</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">marker</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-marker</span><span class="w"></span>

<span class="w">  </span><span class="nt">node_templates</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">my-workstation</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.Compute</span><span class="w"></span>
<span class="w">      </span><span class="nt">attributes</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">private_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"></span>
<span class="w">        </span><span class="nt">public_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"></span>

<span class="w">    </span><span class="nt">hello</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello_type</span><span class="w"></span>
<span class="w">      </span><span class="nt">requirements</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-workstation</span><span class="w"></span>
</pre></div>
</div>
<p>As you can see it is has only one node type defined. This <cite>hello_type</cite> here has two linked implementations that are
actually two TOSCA operations (<cite>create</cite> and <cite>delete</cite>) that are implemented in a form of Ansible playbooks. The Ansible
playbook for creation is shown below and it is used to create a new folder and hello world file in <cite>/tmp</cite> directory.</p>
<p>The Ansible playbook that implements the <cite>create</cite> TOSCA operation looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span><span class="w"></span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Make the location</span><span class="w"></span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/playing-opera/hello</span><span class="w"></span>
<span class="w">        </span><span class="nt">recurse</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">directory</span><span class="w"></span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ansible was here</span><span class="w"></span>
<span class="w">      </span><span class="nt">copy</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/playing-opera/hello/hello.txt</span><span class="w"></span>
<span class="w">        </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">marker</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>And the playbook for destroying the service is below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span><span class="w"></span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>

<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove the location</span><span class="w"></span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/playing-opera</span><span class="w"></span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span><span class="w"></span>
</pre></div>
</div>
<p>The deployment operation returns the following output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span>git clone git@github.com:xlab-si/xopera-opera.git
<span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span><span class="nb">cd</span> examples/hello
<span class="gp gp-VirtualEnv">(.venv)</span> <span class="go">examples/hello$ opera deploy service.yaml</span>
<span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">[Worker_0]   Deployment of hello_0 complete</span>
</pre></div>
</div>
<p>If nothing went wrong, new empty file has been created at <code class="docutils literal notranslate"><span class="pre">/tmp/playing-opera/hello/hello.txt</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">examples/hello$ ls -lh /tmp/playing-opera/hello/</span>
<span class="go">total 0</span>
<span class="go">-rw-rw-rw- 1 user user 0 Feb 20 16:02 hello.txt</span>
</pre></div>
</div>
<p>To delete the created directory, we can undeploy our stuff by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">examples/hello$ opera undeploy</span>
<span class="go">[Worker_0]   Undeploying hello_0</span>
<span class="go">[Worker_0]     Executing delete on hello_0</span>
<span class="go">[Worker_0]   Undeployment of hello_0 complete</span>
<span class="go">[Worker_0]   Undeploying my-workstation_0</span>
<span class="go">[Worker_0]   Undeployment of my-workstation_0 complete</span>
</pre></div>
</div>
<p>After that the created directory and file are deleted:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">examples/hello$ ls -lh /tmp/playing-opera/hello/</span>
<span class="go">ls: cannot access &#39;/tmp/playing-opera/hello/&#39;: No such file or directory</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can retrieve currently installed version with <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">--version/-v</span></code>.</p>
</div>
</div>
<div class="section" id="cli-commands-reference">
<span id="id2"></span><h2>CLI commands reference<a class="headerlink" href="#cli-commands-reference" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">opera</span></code> was originally meant to be used in a terminal as a client and it currently allows users to execute the
following CLI commands:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>CLI command</p></th>
<th class="head"><p>Purpose and description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#opera-deploy">opera deploy</a></p></td>
<td><p>deploy TOSCA service template or CSAR</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#opera-undeploy">opera undeploy</a></p></td>
<td><p>undeploy TOSCA service template or CSAR</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#opera-validate">opera validate</a></p></td>
<td><p>validate TOSCA service template or CSAR</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#opera-outputs">opera outputs</a></p></td>
<td><p>retrieve outputs from service template</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#opera-info">opera info</a></p></td>
<td><p>show information about the current project</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#opera-package">opera package</a></p></td>
<td><p>package templates and accompanying files into CSAR</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#opera-unpackage">opera unpackage</a></p></td>
<td><p>unpackage CSAR into directory</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#opera-diff">opera diff</a></p></td>
<td><p>compare service templates and instances</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#opera-update">opera update</a></p></td>
<td><p>update/redeploy template and instances</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><a class="reference internal" href="#opera-notify">opera notify</a></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">notify the orchestrator about changes after the</div>
<div class="line">deployment and run triggers defined in TOSCA policies</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The commands can be executed in a random order and the orchestrator will warn you in case of any problems.
Each CLI command is described more in detail in the following sections.</p>
<hr class="docutils" />
<div class="section" id="deploy">
<span id="opera-deploy"></span><h3>deploy<a class="headerlink" href="#deploy" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code> - used to deploy and control deployment of the TOSCA application described in YAML or CSAR.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">--resume/-r</span></code> and <code class="docutils literal notranslate"><span class="pre">--clean-state/-c</span></code> options are mutually exclusive.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">deploy</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">inputs</span> <span class="n">INPUTS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">workers</span> <span class="n">WORKERS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="o">|</span> <span class="o">--</span><span class="n">clean</span><span class="o">-</span><span class="n">state</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                    <span class="p">[</span><span class="n">template</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>template</kbd></dt>
<dd><p>TOSCA YAML service template file or CSAR</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--inputs, -i</kbd></dt>
<dd><p>YAML or JSON file with inputs to override the inputs supplied in init</p>
</dd>
<dt><kbd>--workers, -w</kbd></dt>
<dd><p>Maximum number of concurrent deployment threads (positive number, default 1)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the deployment from where it was interrupted</p>
<p>Default: False</p>
</dd>
<dt><kbd>--clean-state, -c</kbd></dt>
<dd><p>Clean the previous deployment state and start over the deployment</p>
<p>Default: False</p>
</dd>
<dt><kbd>--force, -f</kbd></dt>
<dd><p>Force the action and skip any possible prompts</p>
<p>Default: False</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code> command is used to initiate the deployment orchestration process using the supplied TOSCA
service template or the compressed (or uncompressed) TOSCA CSAR.
Within this CLI command the xOpera orchestrator invokes multiple <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/cos01/TOSCA-Simple-Profile-YAML-v1.3-cos01.html#_Toc26969470">TOSCA interface operations</a> (TOSCA
<cite>Standard interface</cite> node operations and also TOSCA <cite>Configure interface</cite> relationship operations).
The operations are executed in the following order:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">create</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pre_configure_source</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pre_configure_target</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">configure</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">post_configure_source</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">post_configure_target</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code></p></li>
</ol>
<p>The operation gets executed if it is defined within the TOSCA service template and has a link to the
corresponding Ansible playbook.</p>
<p>After the deployment the following files and folders will be created in your opera storage directory (by
default that is <code class="docutils literal notranslate"><span class="pre">.opera</span></code> and can be changed using the <code class="docutils literal notranslate"><span class="pre">--instance-path/-p</span></code> flag):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">root_file</span></code> file - contains the path to the service template or CSAR</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inputs</span></code> file - JSON file with the supplied inputs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">instances</span></code> folder - includes JSON files that carry the information about the status of TOSCA node and
relationship instances</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csars</span></code> folder contains the extracted copy of your CSAR (created only if you deployed the compressed TOSCA
CSAR)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">clean-state/-c</span></code> option can be used if you want to clean the current deployment data and status from
opera storage (<cite>.opera</cite> by default) and redeploy again from the start.
And <code class="docutils literal notranslate"><span class="pre">--resume/-r</span></code> can be used to resume the deployment from where it was interrupted (due to some error for
instance) and this will deploy only the the nodes that have not been deployed yet.
Use <code class="docutils literal notranslate"><span class="pre">--force/-f</span></code> option to force the action and skip any possible yes/no prompts.
Use <code class="docutils literal notranslate"><span class="pre">--verbose/-v</span></code> option to see the outputs from the TOSCA executors.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code> CLI command also includes the <code class="docutils literal notranslate"><span class="pre">--workers/-w</span></code> switch, which allows users to specify the
amount of orchestration workers (i.e., concurrent threads).
This enables simultaneous deployment of multiple independent nodes.
By default (if not specified) the number of workers is set to 1 (i.e., only one node is deployed at once).
If the number of specified workers is higher than the number of independent nodes, the orchestrator will take
care of this and will decrease the amount of workers if needed.</p>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/hello-world">hello-world</a> and <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/concurrency">concurrency</a> examples.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/hello-world
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ opera deploy service.yaml</span>
</span><span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">[Worker_0]   Deployment of hello_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera deploy -vcf service.yaml</span>
</span><span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">***inputs***</span>
<span class="go">[&#39;marker: default-marker&#39;]</span>
<span class="go">***inputs***</span>
<span class="go">[Worker_0] ------------</span>
<span class="go">{</span>
<span class="go">    &quot;custom_stats&quot;: {},</span>
<span class="go">    &quot;global_custom_stats&quot;: {},</span>
<span class="go">    &quot;plays&quot;: [</span>
<span class="go">        {</span>
<span class="go">            &quot;play&quot;: {</span>
<span class="go">                &quot;duration&quot;: {</span>
<span class="go">                    &quot;end&quot;: &quot;2021-11-18T09:39:50.479629Z&quot;,</span>
<span class="go">                    &quot;start&quot;: &quot;2021-11-18T09:39:49.775013Z&quot;</span>
<span class="go">                },</span>
<span class="go">                &quot;id&quot;: &quot;33b7ca13-44dc-e7a3-12b1-000000000006&quot;,</span>
<span class="go">                &quot;name&quot;: &quot;all&quot;</span>
<span class="go">            },</span>
<span class="go">            &quot;tasks&quot;: [</span>
<span class="go">                {</span>
<span class="go">                    &quot;hosts&quot;: {</span>
<span class="go">                        &quot;opera&quot;: {</span>
<span class="go">                            &quot;_ansible_no_log&quot;: false,</span>
<span class="go">                            &quot;action&quot;: &quot;file&quot;,</span>
<span class="go">                            &quot;changed&quot;: false,</span>
<span class="go">                            &quot;diff&quot;: {</span>
<span class="go">                                &quot;after&quot;: {</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello&quot;</span>
<span class="go">                                },</span>
<span class="go">                                &quot;before&quot;: {</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello&quot;</span>
<span class="go">                                }</span>
<span class="go">                            },</span>
<span class="go">                            &quot;gid&quot;: 1000,</span>
<span class="go">                            &quot;group&quot;: &quot;anzoman&quot;,</span>
<span class="go">                            &quot;invocation&quot;: {</span>
<span class="go">                                &quot;module_args&quot;: {</span>
<span class="go">                                    &quot;_diff_peek&quot;: null,</span>
<span class="go">                                    &quot;_original_basename&quot;: null,</span>
<span class="go">                                    &quot;access_time&quot;: null,</span>
<span class="go">                                    &quot;access_time_format&quot;: &quot;%Y%m%d%H%M.%S&quot;,</span>
<span class="go">                                    &quot;attributes&quot;: null,</span>
<span class="go">                                    &quot;follow&quot;: true,</span>
<span class="go">                                    &quot;force&quot;: false,</span>
<span class="go">                                    &quot;group&quot;: null,</span>
<span class="go">                                    &quot;mode&quot;: null,</span>
<span class="go">                                    &quot;modification_time&quot;: null,</span>
<span class="go">                                    &quot;modification_time_format&quot;: &quot;%Y%m%d%H%M.%S&quot;,</span>
<span class="go">                                    &quot;owner&quot;: null,</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello&quot;,</span>
<span class="go">                                    &quot;recurse&quot;: true,</span>
<span class="go">                                    &quot;selevel&quot;: null,</span>
<span class="go">                                    &quot;serole&quot;: null,</span>
<span class="go">                                    &quot;setype&quot;: null,</span>
<span class="go">                                    &quot;seuser&quot;: null,</span>
<span class="go">                                    &quot;src&quot;: null,</span>
<span class="go">                                    &quot;state&quot;: &quot;directory&quot;,</span>
<span class="go">                                    &quot;unsafe_writes&quot;: false</span>
<span class="go">                                }</span>
<span class="go">                            },</span>
<span class="go">                            &quot;mode&quot;: &quot;0775&quot;,</span>
<span class="go">                            &quot;owner&quot;: &quot;anzoman&quot;,</span>
<span class="go">                            &quot;path&quot;: &quot;/tmp/playing-opera/hello&quot;,</span>
<span class="go">                            &quot;size&quot;: 4096,</span>
<span class="go">                            &quot;state&quot;: &quot;directory&quot;,</span>
<span class="go">                            &quot;uid&quot;: 1000</span>
<span class="go">                        }</span>
<span class="go">                    },</span>
<span class="go">                    &quot;task&quot;: {</span>
<span class="go">                        &quot;duration&quot;: {</span>
<span class="go">                            &quot;end&quot;: &quot;2021-11-18T09:39:50.025377Z&quot;,</span>
<span class="go">                            &quot;start&quot;: &quot;2021-11-18T09:39:49.781956Z&quot;</span>
<span class="go">                        },</span>
<span class="go">                        &quot;id&quot;: &quot;33b7ca13-44dc-e7a3-12b1-000000000008&quot;,</span>
<span class="go">                        &quot;name&quot;: &quot;Make the location&quot;</span>
<span class="go">                    }</span>
<span class="go">                },</span>
<span class="go">                {</span>
<span class="go">                    &quot;hosts&quot;: {</span>
<span class="go">                        &quot;opera&quot;: {</span>
<span class="go">                            &quot;_ansible_no_log&quot;: false,</span>
<span class="go">                            &quot;action&quot;: &quot;copy&quot;,</span>
<span class="go">                            &quot;changed&quot;: false,</span>
<span class="go">                            &quot;checksum&quot;: &quot;0bcf4d22cec95aaf8b3814d5cf6a208fa119c731&quot;,</span>
<span class="go">                            &quot;dest&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;,</span>
<span class="go">                            &quot;diff&quot;: {</span>
<span class="go">                                &quot;after&quot;: {</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;</span>
<span class="go">                                },</span>
<span class="go">                                &quot;before&quot;: {</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;</span>
<span class="go">                                }</span>
<span class="go">                            },</span>
<span class="go">                            &quot;gid&quot;: 1000,</span>
<span class="go">                            &quot;group&quot;: &quot;anzoman&quot;,</span>
<span class="go">                            &quot;invocation&quot;: {</span>
<span class="go">                                &quot;module_args&quot;: {</span>
<span class="go">                                    &quot;_diff_peek&quot;: null,</span>
<span class="go">                                    &quot;_original_basename&quot;: &quot;tmpexrgiciv&quot;,</span>
<span class="go">                                    &quot;access_time&quot;: null,</span>
<span class="go">                                    &quot;access_time_format&quot;: &quot;%Y%m%d%H%M.%S&quot;,</span>
<span class="go">                                    &quot;attributes&quot;: null,</span>
<span class="go">                                    &quot;dest&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;,</span>
<span class="go">                                    &quot;follow&quot;: true,</span>
<span class="go">                                    &quot;force&quot;: false,</span>
<span class="go">                                    &quot;group&quot;: null,</span>
<span class="go">                                    &quot;mode&quot;: null,</span>
<span class="go">                                    &quot;modification_time&quot;: null,</span>
<span class="go">                                    &quot;modification_time_format&quot;: &quot;%Y%m%d%H%M.%S&quot;,</span>
<span class="go">                                    &quot;owner&quot;: null,</span>
<span class="go">                                    &quot;path&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;,</span>
<span class="go">                                    &quot;recurse&quot;: false,</span>
<span class="go">                                    &quot;selevel&quot;: null,</span>
<span class="go">                                    &quot;serole&quot;: null,</span>
<span class="go">                                    &quot;setype&quot;: null,</span>
<span class="go">                                    &quot;seuser&quot;: null,</span>
<span class="go">                                    &quot;src&quot;: null,</span>
<span class="go">                                    &quot;state&quot;: &quot;file&quot;,</span>
<span class="go">                                    &quot;unsafe_writes&quot;: false</span>
<span class="go">                                }</span>
<span class="go">                            },</span>
<span class="go">                            &quot;mode&quot;: &quot;0664&quot;,</span>
<span class="go">                            &quot;owner&quot;: &quot;anzoman&quot;,</span>
<span class="go">                            &quot;path&quot;: &quot;/tmp/playing-opera/hello/hello.txt&quot;,</span>
<span class="go">                            &quot;size&quot;: 14,</span>
<span class="go">                            &quot;state&quot;: &quot;file&quot;,</span>
<span class="go">                            &quot;uid&quot;: 1000</span>
<span class="go">                        }</span>
<span class="go">                    },</span>
<span class="go">                    &quot;task&quot;: {</span>
<span class="go">                        &quot;duration&quot;: {</span>
<span class="go">                            &quot;end&quot;: &quot;2021-11-18T09:39:50.479629Z&quot;,</span>
<span class="go">                            &quot;start&quot;: &quot;2021-11-18T09:39:50.027874Z&quot;</span>
<span class="go">                        },</span>
<span class="go">                        &quot;id&quot;: &quot;33b7ca13-44dc-e7a3-12b1-000000000009&quot;,</span>
<span class="go">                        &quot;name&quot;: &quot;Ansible was here&quot;</span>
<span class="go">                    }</span>
<span class="go">                }</span>
<span class="go">            ]</span>
<span class="go">        }</span>
<span class="go">    ],</span>
<span class="go">    &quot;stats&quot;: {</span>
<span class="go">        &quot;opera&quot;: {</span>
<span class="go">            &quot;changed&quot;: 0,</span>
<span class="go">            &quot;failures&quot;: 0,</span>
<span class="go">            &quot;ignored&quot;: 0,</span>
<span class="go">            &quot;ok&quot;: 2,</span>
<span class="go">            &quot;rescued&quot;: 0,</span>
<span class="go">            &quot;skipped&quot;: 0,</span>
<span class="go">            &quot;unreachable&quot;: 0</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
<span class="go">[Worker_0] ------------</span>
<span class="go">[Worker_0] ============</span>
<span class="go">[Worker_0]   Deployment of hello_0 complete</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ ../concurrency</span>
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/concurrency$ opera deploy -w 10 service.yaml</span>
</span><span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-1_0</span>
<span class="go">[Worker_2]   Deploying hello-2_0</span>
<span class="go">[Worker_3]   Deploying hello-3_0</span>
<span class="go">[Worker_0]     Executing create on hello-1_0</span>
<span class="go">[Worker_4]   Deploying hello-4_0</span>
<span class="go">[Worker_5]   Deploying hello-8_0</span>
<span class="go">[Worker_3]     Executing create on hello-3_0</span>
<span class="go">[Worker_4]     Executing create on hello-4_0</span>
<span class="go">[Worker_2]     Executing create on hello-2_0</span>
<span class="go">[Worker_1]   Deploying hello-9_0</span>
<span class="go">[Worker_7]   Deploying hello-10_0</span>
<span class="go">[Worker_5]     Executing create on hello-8_0</span>
<span class="go">[Worker_7]     Executing create on hello-10_0</span>
<span class="go">[Worker_1]     Executing create on hello-9_0</span>
<span class="go">[Worker_1]     Executing start on hello-9_0</span>
<span class="go">[Worker_4]     Executing start on hello-4_0</span>
<span class="go">[Worker_3]     Executing start on hello-3_0</span>
<span class="go">[Worker_7]     Executing start on hello-10_0</span>
<span class="go">[Worker_1]   Deployment of hello-9_0 complete</span>
<span class="go">[Worker_3]   Deployment of hello-3_0 complete</span>
<span class="go">[Worker_6]   Deploying hello-12_0</span>
<span class="go">[Worker_6]     Executing create on hello-12_0</span>
<span class="go">[Worker_4]   Deployment of hello-4_0 complete</span>
<span class="go">[Worker_1]   Deploying hello-13_0</span>
<span class="go">[Worker_1]     Executing create on hello-13_0</span>
<span class="go">[Worker_5]     Executing start on hello-8_0</span>
<span class="go">[Worker_0]     Executing start on hello-1_0</span>
<span class="go">[Worker_2]     Executing start on hello-2_0</span>
<span class="go">[Worker_6]     Executing start on hello-12_0</span>
<span class="go">[Worker_7]   Deployment of hello-10_0 complete</span>
<span class="go">[Worker_1]     Executing start on hello-13_0</span>
<span class="go">[Worker_6]   Deployment of hello-12_0 complete</span>
<span class="go">[Worker_5]   Deployment of hello-8_0 complete</span>
<span class="go">[Worker_0]   Deployment of hello-1_0 complete</span>
<span class="go">[Worker_3]   Deploying hello-5_0</span>
<span class="go">[Worker_3]     Executing create on hello-5_0</span>
<span class="go">[Worker_8]   Deploying hello-11_0</span>
<span class="go">[Worker_8]     Executing create on hello-11_0</span>
<span class="go">[Worker_1]   Deployment of hello-13_0 complete</span>
<span class="go">[Worker_2]   Deployment of hello-2_0 complete</span>
<span class="go">[Worker_8]     Executing start on hello-11_0</span>
<span class="go">[Worker_3]     Executing start on hello-5_0</span>
<span class="go">[Worker_8]   Deployment of hello-11_0 complete</span>
<span class="go">[Worker_3]   Deployment of hello-5_0 complete</span>
<span class="go">[Worker_4]   Deploying hello-6_0</span>
<span class="go">[Worker_4]     Executing create on hello-6_0</span>
<span class="go">[Worker_4]     Executing start on hello-6_0</span>
<span class="go">[Worker_4]   Deployment of hello-6_0 complete</span>
<span class="go">[Worker_9]   Deploying hello-7_0</span>
<span class="go">[Worker_9]     Executing create on hello-7_0</span>
<span class="go">[Worker_9]     Executing start on hello-7_0</span>
<span class="go">[Worker_9]   Deployment of hello-7_0 complete</span>
<span class="go">[Worker_7]   Deploying hello-14_0</span>
<span class="go">[Worker_7]     Executing create on hello-14_0</span>
<span class="go">[Worker_7]     Executing start on hello-14_0</span>
<span class="go">[Worker_7]   Deployment of hello-14_0 complete</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="undeploy">
<span id="opera-undeploy"></span><h3>undeploy<a class="headerlink" href="#undeploy" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">undeploy</span></code> - undeploys application; removes all application instances and components.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-1-1-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-2" name="1-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">undeploy</span></code> command does not take any positional arguments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">undeploy</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">workers</span> <span class="n">WORKERS</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">resume</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--workers, -w</kbd></dt>
<dd><p>Maximum number of concurrent undeployment threads (positive number, default 1)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the undeployment from where it was interrupted</p>
<p>Default: False</p>
</dd>
<dt><kbd>--force, -f</kbd></dt>
<dd><p>Force the action and skip any possible prompts</p>
<p>Default: False</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">undeploy</span></code> command is used to tear down the deployed blueprint. Within the undeployment process the
xOpera orchestrator invokes two TOSCA Standard interface node operations in the following order:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete</span></code></p></li>
</ol>
<p>The operation gets executed if it is defined within the TOSCA service template and has a link to the
corresponding implementation (e.g., Ansible playbook).</p>
<p>The undeploy CLI command also accepts flags similar to deploy command: <code class="docutils literal notranslate"><span class="pre">--resume/-r</span></code>, <code class="docutils literal notranslate"><span class="pre">--force/-f</span></code> and
<code class="docutils literal notranslate"><span class="pre">--workers/-w</span></code>.</p>
</div><div aria-labelledby="tab-1-1-2" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-2" name="1-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/hello-world">hello-world</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/hello-world
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ opera deploy service.yaml</span>
<span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">[Worker_0]   Deployment of hello_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ opera undeploy</span>
</span><span class="go">[Worker_0]   Undeploying hello_0</span>
<span class="go">[Worker_0]     Executing delete on hello_0</span>
<span class="go">[Worker_0]   Undeployment of hello_0 complete</span>
<span class="go">[Worker_0]   Undeploying my-workstation_0</span>
<span class="go">[Worker_0]   Undeployment of my-workstation_0 complete</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="validate">
<span id="opera-validate"></span><h3>validate<a class="headerlink" href="#validate" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">validate</span></code> - validates the structure of TOSCA template or CSAR.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-2-2-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-2" name="2-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">validate</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">inputs</span> <span class="n">INPUTS</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">executors</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                      <span class="p">[</span><span class="n">csar_or_service_template</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>csar_or_service_template</kbd></dt>
<dd><p>TOSCA YAML service template file or CSAR</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--inputs, -i</kbd></dt>
<dd><p>YAML or JSON file with inputs</p>
</dd>
<dt><kbd>--executors, -e</kbd></dt>
<dd><p>Validate TOSCA templates and also the executors (e.g., Ansible playbooks) behind them</p>
<p>Default: False</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><p>With <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">validate</span></code> you can validate any TOSCA template or CSAR (including its inputs) and find out whether
it’s properly structured and deployable by opera.
At the end of this operation you will receive the validation result where opera will warn you about TOSCA
template inconsistencies if there was any.
Since validation can be successful or unsuccessful the <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">validate</span></code> command has corresponding return
codes - 0 for success and 1 for failure.
If the validation succeeds this means that your TOSCA templates are valid and that all their implementations
(e.g., Ansible playbooks) can be invoked.
However, this doesn’t mean that these operations will succeed.
To also check the executors behind the TOSCA templates, you can use the <code class="docutils literal notranslate"><span class="pre">--executors/-e</span></code> options that will
not deploy anything, but will just try to run the executors in test mode (e.g., Ansible check mode).</p>
</div><div aria-labelledby="tab-2-2-2" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-2" name="2-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/csars/misc-tosca-types">misc-tosca-types-csar</a> and <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/hello-world">hello-world</a> examples.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> csars/misc-tosca-types
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera validate -i inputs.yaml service.yaml</span>
</span><span class="go">Validating service template...</span>
<span class="go">Done.</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> ../../hello-world
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ opera validate --executors service.yaml</span>
</span><span class="go">Validating service template...</span>
<span class="go">[Worker_0]   Validating my-workstation_0</span>
<span class="go">[Worker_0]   Validation of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Validating hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">[Worker_0]     Executing delete on hello_0</span>
<span class="go">[Worker_0]   Validation of hello_0 complete</span>
<span class="go">Done.</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="outputs">
<span id="opera-outputs"></span><h3>outputs<a class="headerlink" href="#outputs" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">outputs</span></code> - print the outputs from service template (after deployment/undeployment).</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">outputs</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">yaml</span><span class="p">,</span><span class="n">json</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--format, -f</kbd></dt>
<dd><p>Possible choices: yaml, json</p>
<p>Output format</p>
<p>Default: “yaml”</p>
</dd>
<dt><kbd>--output, -o</kbd></dt>
<dd><p>Output file location</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">outputs</span></code> command lets you access the orchestration outputs defined in the TOSCA service template
and print them out to the console in JSON or YAML format (used by default).</p>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/tosca/outputs">outputs</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> tosca/outputs
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/outputs$ opera deploy service.yaml</span>
<span class="go">[Worker_0]   Deploying my_node_0</span>
<span class="go">[Worker_0]     Executing create on my_node_0</span>
<span class="go">[Worker_0]   Deployment of my_node_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/outputs$ opera outputs</span>
</span><span class="go">output_prop:</span>
<span class="go">  description: Example of property output</span>
<span class="go">  value: 123</span>
<span class="go">output_attr:</span>
<span class="go">  description: Example of attribute output</span>
<span class="go">  value: my_custom_attribute_value</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/outputs$ opera outputs --format json</span>
</span><span class="go">{</span>
<span class="go">  &quot;output_prop&quot;: {</span>
<span class="go">    &quot;description&quot;: &quot;Example of property output&quot;,</span>
<span class="go">    &quot;value&quot;: 123</span>
<span class="go">  },</span>
<span class="go">  &quot;output_attr&quot;: {</span>
<span class="go">    &quot;description&quot;: &quot;Example of attribute output&quot;,</span>
<span class="go">    &quot;value&quot;: &quot;my_custom_attribute_value&quot;</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="info">
<span id="opera-info"></span><h3>info<a class="headerlink" href="#info" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">info</span></code> - print the details of current deployment project.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-4-4-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-2" name="4-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">info</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">yaml</span><span class="p">,</span><span class="n">json</span><span class="p">}]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                  <span class="p">[</span><span class="n">csar_or_rootdir</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>csar_or_rootdir</kbd></dt>
<dd><p>Path to a packed or unpacked TOSCA CSAR (defaults to the current directory if not specified)</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--format, -f</kbd></dt>
<dd><p>Possible choices: yaml, json</p>
<p>Output format</p>
<p>Default: “yaml”</p>
</dd>
<dt><kbd>--output, -o</kbd></dt>
<dd><p>Output file location</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><p>With <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">info</span></code> user can get the information about the current opera project and can access its storage and
state.
This includes printing out the path to TOSCA service template entrypoint, extracted CSAR location, path to the
storage inputs, status/state of the deployment, TOSCA CSAR/service template metadata and CSAR validation status.
The output can be formatted in YAML or JSON. The created JSON object looks like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;service_template&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;string | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;content_root&quot;</span><span class="p">:</span><span class="w">              </span><span class="s2">&quot;string | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;inputs&quot;</span><span class="p">:</span><span class="w">                    </span><span class="s2">&quot;string | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w">                    </span><span class="s2">&quot;deploying | deployed | undeploying | undeployed | error | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;csar_metadata&quot;</span><span class="p">:</span><span class="w">             </span><span class="s2">&quot;YAML map | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;service_template_metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;YAML map | null&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;csar_valid&quot;</span><span class="p">:</span><span class="w">                </span><span class="s2">&quot;true | false | null&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>xOpera TOSCA orchestration tool now provides the following orchestration states (the are also CLI commands
that trigger changing the state in the brackets):</p>
<ul class="simple">
<li><p><cite>deploying</cite> (<code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code>)</p></li>
<li><p><cite>deployed</cite> (<code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code>)</p></li>
<li><p><cite>undeploying</cite> (<code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">undeploy</span></code>)</p></li>
<li><p><cite>undeployed</cite> (<code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">undeploy</span></code>)</p></li>
<li><p><cite>error</cite> (<code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy/undeploy/update/notify</span></code>)</p></li>
<li><p><cite>unknown</cite> (for special cases which might happen)</p></li>
</ul>
<p>These state are changed during the execution of TOSCA interface operations (e.g., Ansible playbooks).</p>
</div><div aria-labelledby="tab-4-4-2" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-2" name="4-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/csars/misc-tosca-types">misc-tosca-types-csar</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> csars/misc-tosca-types
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera info</span>
</span><span class="go">service_template: service.yaml</span>
<span class="go">content_root: .</span>
<span class="go">inputs: null</span>
<span class="go">status: null</span>
<span class="go">csar_metadata:</span>
<span class="go">  Name: null</span>
<span class="go">  Content-Type: null</span>
<span class="go">  TOSCA-Meta-File-Version: &#39;1.1&#39;</span>
<span class="go">  CSAR-Version: &#39;1.1&#39;</span>
<span class="go">  Created-By: XLAB</span>
<span class="go">  Entry-Definitions: service.yaml</span>
<span class="go">service_template_metadata: null</span>
<span class="go">csar_valid: true</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera deploy -i inputs.yaml service.yaml</span>
<span class="go">[Worker_0]   Deploying my-workstation1_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation1_0 complete</span>
<span class="go">[Worker_0]   Deploying my-workstation2_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation2_0 complete</span>
<span class="go">[Worker_0]   Deploying file_0</span>
<span class="go">[Worker_0]     Executing create on file_0</span>
<span class="go">[Worker_0]   Deployment of file_0 complete</span>
<span class="go">[Worker_0]   Deploying hello_0</span>
<span class="go">[Worker_0]     Executing create on hello_0</span>
<span class="go">[Worker_0]   Deployment of hello_0 complete</span>
<span class="go">[Worker_0]   Deploying interfaces_0</span>
<span class="go">[Worker_0]     Executing create on interfaces_0</span>
<span class="go">^C[Worker_0] ------------</span>
<span class="go">KeyboardInterrupt</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera info -f json</span>
</span><span class="go">{</span>
<span class="go">  &quot;service_template&quot;: &quot;service.yaml&quot;,</span>
<span class="go">  &quot;content_root&quot;: &quot;.&quot;,</span>
<span class="go">  &quot;inputs&quot;: {</span>
<span class="go">    &quot;host_ip&quot;: &quot;localhost&quot;,</span>
<span class="go">    &quot;slovenian_greeting&quot;: &quot;Hej prijatelj, pojdi z nami!&quot;</span>
<span class="go">  },</span>
<span class="go">  &quot;status&quot;: &quot;error&quot;,</span>
<span class="go">  &quot;csar_metadata&quot;: {</span>
<span class="go">    &quot;Name&quot;: null,</span>
<span class="go">    &quot;Content-Type&quot;: null,</span>
<span class="go">    &quot;TOSCA-Meta-File-Version&quot;: &quot;1.1&quot;,</span>
<span class="go">    &quot;CSAR-Version&quot;: &quot;1.1&quot;,</span>
<span class="go">    &quot;Created-By&quot;: &quot;XLAB&quot;,</span>
<span class="go">    &quot;Entry-Definitions&quot;: &quot;service.yaml&quot;</span>
<span class="go">  },</span>
<span class="go">  &quot;service_template_metadata&quot;: null,</span>
<span class="go">  &quot;csar_valid&quot;: true</span>
<span class="go">}</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera deploy --resume --force</span>
<span class="go">[Worker_0]   Deploying interfaces_0</span>
<span class="go">[Worker_0]     Executing create on interfaces_0</span>
<span class="go">[Worker_0]     Executing configure on interfaces_0</span>
<span class="go">[Worker_0]     Executing start on interfaces_0</span>
<span class="go">[Worker_0]   Deployment of interfaces_0 complete</span>
<span class="go">[Worker_0]   Deploying noimpl_0</span>
<span class="go">[Worker_0]   Deployment of noimpl_0 complete</span>
<span class="go">[Worker_0]   Deploying setter_0</span>
<span class="go">[Worker_0]     Executing create on setter_0</span>
<span class="go">[Worker_0]   Deployment of setter_0 complete</span>
<span class="go">[Worker_0]   Deploying test_0</span>
<span class="go">[Worker_0]     Executing create on test_0</span>
<span class="go">[Worker_0]   Deployment of test_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera info -f yaml</span>
</span><span class="go">service_template: service.yaml</span>
<span class="go">content_root: .</span>
<span class="go">inputs:</span>
<span class="go">  host_ip: localhost</span>
<span class="go">  slovenian_greeting: Hej prijatelj, pojdi z nami!</span>
<span class="go">status: deployed</span>
<span class="go">csar_metadata:</span>
<span class="go">  Name: null</span>
<span class="go">  Content-Type: null</span>
<span class="go">  TOSCA-Meta-File-Version: &#39;1.1&#39;</span>
<span class="go">  CSAR-Version: &#39;1.1&#39;</span>
<span class="go">  Created-By: XLAB</span>
<span class="go">  Entry-Definitions: service.yaml</span>
<span class="go">service_template_metadata: null</span>
<span class="go">csar_valid: true</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera undeploy</span>
<span class="go">[Worker_0]   Undeploying my-workstation2_0</span>
<span class="go">[Worker_0]   Undeployment of my-workstation2_0 complete</span>
<span class="go">[Worker_0]   Undeploying file_0</span>
<span class="go">[Worker_0]     Executing delete on file_0</span>
<span class="go">[Worker_0]   Undeployment of file_0 complete</span>
<span class="go">[Worker_0]   Undeploying interfaces_0</span>
<span class="go">[Worker_0]     Executing stop on interfaces_0</span>
<span class="go">[Worker_0]     Executing delete on interfaces_0</span>
<span class="go">[Worker_0]   Undeployment of interfaces_0 complete</span>
<span class="go">[Worker_0]   Undeploying noimpl_0</span>
<span class="go">[Worker_0]   Undeployment of noimpl_0 complete</span>
<span class="go">[Worker_0]   Undeploying setter_0</span>
<span class="go">[Worker_0]   Undeployment of setter_0 complete</span>
<span class="go">[Worker_0]   Undeploying hello_0</span>
<span class="go">[Worker_0]   Undeployment of hello_0 complete</span>
<span class="go">[Worker_0]   Undeploying my-workstation1_0</span>
<span class="go">[Worker_0]   Undeployment of my-workstation1_0 complete</span>
<span class="go">[Worker_0]   Undeploying test_0</span>
<span class="go">[Worker_0]   Undeployment of test_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars/misc-tosca-types$ opera info</span>
</span><span class="go">service_template: service.yaml</span>
<span class="go">content_root: .</span>
<span class="go">inputs:</span>
<span class="go">  host_ip: localhost</span>
<span class="go">  slovenian_greeting: Hej prijatelj, pojdi z nami!</span>
<span class="go">status: undeployed</span>
<span class="go">csar_metadata:</span>
<span class="go">  Name: null</span>
<span class="go">  Content-Type: null</span>
<span class="go">  TOSCA-Meta-File-Version: &#39;1.1&#39;</span>
<span class="go">  CSAR-Version: &#39;1.1&#39;</span>
<span class="go">  Created-By: XLAB</span>
<span class="go">  Entry-Definitions: service.yaml</span>
<span class="go">service_template_metadata: null</span>
<span class="go">csar_valid: true</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="package">
<span id="opera-package"></span><h3>package<a class="headerlink" href="#package" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">package</span></code> - package TOSCA YAML templates and their accompanying files to a compressed TOSCA CSAR.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-5-5-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-2" name="5-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">package</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">service</span><span class="o">-</span><span class="n">template</span> <span class="n">SERVICE_TEMPLATE</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="nb">zip</span><span class="p">,</span><span class="n">tar</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                     <span class="n">service_template_folder</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>service_template_folder</kbd></dt>
<dd><p>Path to the root of the service template or folder you want to create the TOSCA CSAR from</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--service-template, -t</kbd></dt>
<dd><p>Name or path to the TOSCA service template file from the root of the input folder</p>
</dd>
<dt><kbd>--output, -o</kbd></dt>
<dd><p>Output CSAR file path</p>
</dd>
<dt><kbd>--format, -f</kbd></dt>
<dd><p>Possible choices: zip, tar</p>
<p>CSAR compressed file format</p>
<p>Default: “zip”</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">package</span></code> command is used to create a valid TOSCA CSAR - a deployable zip (or tar) compressed
archive file (CSAR = Cloud Service Archive).
TOSCA CSARs contain the blueprint of the application that we want to deploy.
The process includes packaging together the TOSCA service template and all the accompanying files.</p>
<p>In general, <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">package</span></code> receives a directory (where user’s TOSCA templates and other files are located)
and produces a compressed CSAR file.
The command can create the CSAR if there is at least one TOSCA YAML file in the input folder.
If the CSAR structure is already present (if <cite>TOSCA-Metadata/TOSCA.meta</cite> or exists or <code class="docutils literal notranslate"><span class="pre">metadata</span></code> is present
in the TOSCA service template and if all other TOSCA CSAR constraints are satisfied) the CSAR is created
without an additional temporary directory.
And if not, the files are copied to the tempdir, where the CSAR structure is created and at the end the tempdir
is compressed.
The input folder is the mandatory positional argument, but there are also other command flags that can be used.</p>
</div><div aria-labelledby="tab-5-5-2" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-2" name="5-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/hello-world">hello-world</a> and <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/csars/misc-tosca-types">misc-tosca-types-csar</a> examples.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/hello-world
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ opera package .</span>
</span><span class="go">CSAR was created and packed to &#39;/home/user/Desktop/xopera-examples/misc/hello-world/opera-package-45045f.zip&#39;.</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/hello-world$ cd ../../csars</span>
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars$ opera package -t service.yaml -o misc-tosca-types  misc-tosca-types/</span>
</span><span class="go">CSAR was created and packed to &#39;/home/user/Desktop/xopera-examples/csars/misc-tosca-types.zip&#39;.</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="unpackage">
<span id="opera-unpackage"></span><h3>unpackage<a class="headerlink" href="#unpackage" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">unpackage</span></code> - uncompress TOSCA CSAR (to a specified directory).</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-6-6-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-1" name="6-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-6-6-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-2" name="6-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">unpackage</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">destination</span> <span class="n">DESTINATION</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span> <span class="n">csar</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>csar</kbd></dt>
<dd><p>Path to the compressed TOSCA CSAR</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--destination, -d</kbd></dt>
<dd><p>Path to the location where the CSAR file will be extracted to, the path will be generated in the current working directory if it isn’t specified</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-6-6-1" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-1" name="6-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">unpackage</span></code> has the opposite function of the <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">package</span></code> command.
It serves for unpacking (i.e. validating and extracting) the compressed TOSCA CSAR files.
The opera unpackage command receives a compressed CSAR as a positional argument.
It then validates and extracts the CSAR to a given location.</p>
<p>There’s no <code class="docutils literal notranslate"><span class="pre">--format/-f</span></code> option. Rather than that, the compressed file format (that will be used to extract
the CSAR) is determined automatically.
Currently, the compressed CSARs can be supplied in two different compression formats - <cite>zip</cite> or <cite>tar</cite>.</p>
</div><div aria-labelledby="tab-6-6-2" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-2" name="6-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/csars/misc-tosca-types">misc-tosca-types-csar</a> and <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/csars/small">small-csar</a> examples.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> csars
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars$ opera package -t service.yaml -o misc-tosca-types misc-tosca-types/</span>
<span class="go">CSAR was created and packed to &#39;/home/user/Desktop/xopera-examples/csars/misc-tosca-types.zip&#39;.</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars$ opera unpackage misc-tosca-types.zip</span>
</span><span class="go">The CSAR was unpackaged to &#39;/home/user/Desktop/xopera-examples/csars/opera-unpackage-1cabf6&#39;.</span>

<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars$ opera package -t service.yaml -o small small/</span>
<span class="go">CSAR was created and packed to &#39;/home/user/Desktop/xopera-examples/csars/small.zip&#39;.</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">csars$ opera unpackage -d small-extracted small.zip</span>
</span><span class="go">The CSAR was unpackaged to &#39;/home/user/Desktop/xopera-examples/csars/small-extracted&#39;.</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="diff">
<span id="opera-diff"></span><h3>diff<a class="headerlink" href="#diff" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">diff</span></code> - compare TOSCA service templates and instances.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-7-7-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-1" name="7-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-7-7-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-2" name="7-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">diff</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">inputs</span> <span class="n">INPUTS</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">template</span><span class="o">-</span><span class="n">only</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">yaml</span><span class="p">,</span><span class="n">json</span><span class="p">}]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span><span class="p">]</span>
                  <span class="p">[</span><span class="n">template</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>template</kbd></dt>
<dd><p>TOSCA YAML service template file</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--inputs, -i</kbd></dt>
<dd><p>Optional: YAML or JSON file with inputs that will be used along with the comparison</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
<dt><kbd>--template-only, -t</kbd></dt>
<dd><p>Compare only templates without instances</p>
<p>Default: False</p>
</dd>
<dt><kbd>--format, -f</kbd></dt>
<dd><p>Possible choices: yaml, json</p>
<p>Output format</p>
<p>Default: “yaml”</p>
</dd>
<dt><kbd>--output, -o</kbd></dt>
<dd><p>Output file location</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-7-7-1" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-1" name="7-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">diff</span></code> CLI command holds the functionality to find the differences between the deployed TOSCA
service template and the updated TOSCA service template that you wish to redeploy.
Moreover, this operation compares the desired TOSCA service template to the one from the opera project storage
(by default this one is located in <code class="docutils literal notranslate"><span class="pre">.opera</span></code>) and print out their differences.</p>
<p>The command includes two sub-operations that invoke template and instance comparers.
The template comparer allows the comparison of changed blueprint (and changed inputs) in a folder containing
the existing TOSCA service template that was deployed before.
The instance comparer looks for changes in instance states and also traverses the dependency graph in order to
propagate changes from parent to child nodes.
If a parent node is marked as changed, then child node is also considered changed.</p>
<p>The output of <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">diff</span></code> is a human readable representation of templates differences, is formatted either
as JSON or YAML (default) and can be optionally saved in a file.</p>
</div><div aria-labelledby="tab-7-7-2" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-2" name="7-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/compare-templates">compare-templates</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/compare-templates
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/compare-templates$ opera deploy -i inputs1.yaml service1.yaml</span>
<span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-1_0</span>
<span class="go">[Worker_0]     Executing create on hello-1_0</span>
<span class="go">[Worker_0]   Deployment of hello-1_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-2_0</span>
<span class="go">[Worker_0]     Executing create on hello-2_0</span>
<span class="go">[Worker_0]   Deployment of hello-2_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-3_0</span>
<span class="go">[Worker_0]     Executing create on hello-3_0</span>
<span class="go">[Worker_0]   Deployment of hello-3_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-4_0</span>
<span class="go">[Worker_0]     Executing create on hello-4_0</span>
<span class="go">[Worker_0]   Deployment of hello-4_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-6_0</span>
<span class="go">[Worker_0]     Executing create on hello-6_0</span>
<span class="go">[Worker_0]   Deployment of hello-6_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/compare-templates$ opera diff -i inputs2.yaml service2.yaml</span>
</span><span class="go">nodes:</span>
<span class="go">added:</span>
<span class="go">- hello-5</span>
<span class="go">changed:</span>
<span class="go"> hello-1:</span>
<span class="go">   capabilities:</span>
<span class="go">     deleted:</span>
<span class="go">     - test</span>
<span class="go">   interfaces:</span>
<span class="go">     Standard:</span>
<span class="go">       operations:</span>
<span class="go">         create:</span>
<span class="go">           artifacts:</span>
<span class="go">             added:</span>
<span class="go">             - lib/files/file1_2.yaml</span>
<span class="go">             deleted:</span>
<span class="go">             - lib/files/file1_1.yaml</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">             time:</span>
<span class="go">             - &#39;0&#39;</span>
<span class="go">             - &#39;1&#39;</span>
<span class="go">         delete:</span>
<span class="go">           artifacts:</span>
<span class="go">             added:</span>
<span class="go">             - lib/files/file1_2.yaml</span>
<span class="go">             deleted:</span>
<span class="go">             - lib/files/file1_1.yaml</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">             time:</span>
<span class="go">             - &#39;0&#39;</span>
<span class="go">             - &#39;1&#39;</span>
<span class="go">   properties:</span>
<span class="go">     time:</span>
<span class="go">     - &#39;0&#39;</span>
<span class="go">     - &#39;1&#39;</span>
<span class="go"> hello-2:</span>
<span class="go">   capabilities:</span>
<span class="go">     test:</span>
<span class="go">       properties:</span>
<span class="go">         test1:</span>
<span class="go">         - &#39;2&#39;</span>
<span class="go">         - &#39;3&#39;</span>
<span class="go">         test2:</span>
<span class="go">         - &#39;2&#39;</span>
<span class="go">         - &#39;3&#39;</span>
<span class="go">   dependencies:</span>
<span class="go">   - hello-2</span>
<span class="go">   interfaces:</span>
<span class="go">     Standard:</span>
<span class="go">       operations:</span>
<span class="go">         create:</span>
<span class="go">           artifacts:</span>
<span class="go">             added:</span>
<span class="go">             - lib/files/file2.yaml</span>
<span class="go">             deleted:</span>
<span class="go">             - lib/files/file1_1.yaml</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">         delete:</span>
<span class="go">           artifacts:</span>
<span class="go">             added:</span>
<span class="go">             - lib/files/file2.yaml</span>
<span class="go">             deleted:</span>
<span class="go">             - lib/files/file1_1.yaml</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">   properties:</span>
<span class="go">     day:</span>
<span class="go">     - &#39;1&#39;</span>
<span class="go">     - &#39;2&#39;</span>
<span class="go">   requirements:</span>
<span class="go">     added:</span>
<span class="go">     - dependency</span>
<span class="go">   types:</span>
<span class="go">   - hello_type_old</span>
<span class="go">   - hello_type_new</span>
<span class="go"> hello-3:</span>
<span class="go">   interfaces:</span>
<span class="go">     Standard:</span>
<span class="go">       operations:</span>
<span class="go">         create:</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">         delete:</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go"> hello-6:</span>
<span class="go">   dependencies:</span>
<span class="go">   - hello-6</span>
<span class="go">   interfaces:</span>
<span class="go">     Standard:</span>
<span class="go">       operations:</span>
<span class="go">         create:</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">         delete:</span>
<span class="go">           inputs:</span>
<span class="go">             marker:</span>
<span class="go">             - marker1</span>
<span class="go">             - marker2</span>
<span class="go">   requirements:</span>
<span class="go">     dependency:</span>
<span class="go">       target:</span>
<span class="go">       - hello-1</span>
<span class="go">       - hello-2</span>
<span class="go">deleted:</span>
<span class="go">- hello-4</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="update">
<span id="opera-update"></span><h3>update<a class="headerlink" href="#update" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">update</span></code> - update the deployed TOSCA service template and redeploy it according to the discovered template diff.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-8-8-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-1" name="8-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-8-8-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-2" name="8-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">update</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">inputs</span> <span class="n">INPUTS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">workers</span> <span class="n">WORKERS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                    <span class="p">[</span><span class="n">template</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="Positional Arguments">
<h4>Positional Arguments<a class="headerlink" href="#Positional Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>template</kbd></dt>
<dd><p>TOSCA YAML service template file</p>
</dd>
</dl>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--inputs, -i</kbd></dt>
<dd><p>Optional: YAML or JSON file with inputs that will be used for deployment update</p>
</dd>
<dt><kbd>--workers, -w</kbd></dt>
<dd><p>Maximum number of concurrent update threads (positive number, default 1)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Turns on verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-8-8-1" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-1" name="8-1" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">update</span></code> command extends the usage of <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">diff</span></code> and is able to redeploy the update TOSCA
service template according to the changes that were made to the previously deployed template.
This means that <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">update</span></code> will first compare the two templates and instances with and then redeploy.</p>
<p>The user is able to run update command providing a changed blueprint and inputs in a folder containing existing
service template that was deployed before.
The result of the execution would be undeployment of the nodes that were removed from the service template,
deployment of the nodes that were added to the service template and consequential undeployment/deployment of
changed nodes.</p>
</div><div aria-labelledby="tab-8-8-2" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-2" name="8-2" role="tabpanel" tabindex="0"><p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/compare-templates">compare-templates</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/compare-templates
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/compare-templates$ opera deploy -i inputs1.yaml service1.yaml</span>
<span class="go">[Worker_0]   Deploying my-workstation_0</span>
<span class="go">[Worker_0]   Deployment of my-workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-1_0</span>
<span class="go">[Worker_0]     Executing create on hello-1_0</span>
<span class="go">[Worker_0]   Deployment of hello-1_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-2_0</span>
<span class="go">[Worker_0]     Executing create on hello-2_0</span>
<span class="go">[Worker_0]   Deployment of hello-2_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-3_0</span>
<span class="go">[Worker_0]     Executing create on hello-3_0</span>
<span class="go">[Worker_0]   Deployment of hello-3_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-4_0</span>
<span class="go">[Worker_0]     Executing create on hello-4_0</span>
<span class="go">[Worker_0]   Deployment of hello-4_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-6_0</span>
<span class="go">[Worker_0]     Executing create on hello-6_0</span>
<span class="go">[Worker_0]   Deployment of hello-6_0 complete</span>

<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/compare-templates$ opera update -i inputs2.yaml service2.yaml</span>
</span><span class="go">[Worker_0]   Undeploying hello-2_0</span>
<span class="go">[Worker_0]     Executing delete on hello-2_0</span>
<span class="go">[Worker_0]   Undeployment of hello-2_0 complete</span>
<span class="go">[Worker_0]   Undeploying hello-3_0</span>
<span class="go">[Worker_0]     Executing delete on hello-3_0</span>
<span class="go">[Worker_0]   Undeployment of hello-3_0 complete</span>
<span class="go">[Worker_0]   Undeploying hello-4_0</span>
<span class="go">[Worker_0]     Executing delete on hello-4_0</span>
<span class="go">[Worker_0]   Undeployment of hello-4_0 complete</span>
<span class="go">[Worker_0]   Undeploying hello-6_0</span>
<span class="go">[Worker_0]     Executing delete on hello-6_0</span>
<span class="go">[Worker_0]   Undeployment of hello-6_0 complete</span>
<span class="go">[Worker_0]   Undeploying hello-1_0</span>
<span class="go">[Worker_0]     Executing delete on hello-1_0</span>
<span class="go">[Worker_0]   Undeployment of hello-1_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-1_0</span>
<span class="go">[Worker_0]     Executing create on hello-1_0</span>
<span class="go">[Worker_0]   Deployment of hello-1_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-2_0</span>
<span class="go">[Worker_0]     Executing create on hello-2_0</span>
<span class="go">[Worker_0]   Deployment of hello-2_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-3_0</span>
<span class="go">[Worker_0]     Executing create on hello-3_0</span>
<span class="go">[Worker_0]   Deployment of hello-3_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-5_0</span>
<span class="go">[Worker_0]     Executing create on hello-5_0</span>
<span class="go">[Worker_0]   Deployment of hello-5_0 complete</span>
<span class="go">[Worker_0]   Deploying hello-6_0</span>
<span class="go">[Worker_0]     Executing create on hello-6_0</span>
<span class="go">[Worker_0]   Deployment of hello-6_0 complete</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
<div class="section" id="notify">
<span id="opera-notify"></span><h3>notify<a class="headerlink" href="#notify" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> - notify the orchestrator about changes after deployment and run triggers defined in TOSCA policies.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-9-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-9-9-0" name="9-0" role="tab" tabindex="0">Usage</button><button aria-controls="panel-9-9-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-1" name="9-1" role="tab" tabindex="-1">Description</button><button aria-controls="panel-9-9-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-2" name="9-2" role="tab" tabindex="-1">Example</button></div><div aria-labelledby="tab-9-9-0" class="sphinx-tabs-panel" id="panel-9-9-0" name="9-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">opera</span> <span class="n">notify</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">instance</span><span class="o">-</span><span class="n">path</span> <span class="n">INSTANCE_PATH</span><span class="p">]</span> <span class="o">--</span><span class="n">trigger</span>
                    <span class="n">TRIGGER_OR_EVENT</span> <span class="p">[</span><span class="o">--</span><span class="n">notification</span> <span class="n">NOTIFICATION</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="options">
<h4>options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>--instance-path, -p</kbd></dt>
<dd><p>Storage folder location (instead of default .opera)</p>
</dd>
<dt><kbd>--trigger, -t, --event, -e</kbd></dt>
<dd><p>TOSCA policy trigger name or event that will invoke all the actions (interface operations) on policy</p>
</dd>
<dt><kbd>--notification, -n</kbd></dt>
<dd><p>Notification file (usually JSON) with changes that will be exposed to TOSCA interfaces</p>
</dd>
<dt><kbd>--force, -f</kbd></dt>
<dd><p>Skip any prompts and force execution</p>
<p>Default: False</p>
</dd>
<dt><kbd>--verbose, -v</kbd></dt>
<dd><p>Enable verbose mode</p>
<p>Default: False</p>
</dd>
</dl>
</div>
</div><div aria-labelledby="tab-9-9-1" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-1" name="9-1" role="tabpanel" tabindex="0"><p>There are cases when the user would want to execute some tasks after the deployment based on the changes that
occur on already deployed instances at runtime.
With <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> command, the user can inform the orchestrator about the changes (e.g., CPU load has
increased) and the orchestrator will invoke the operations that are needed to make necessary actions (e.g.,
horizontal or vertical scaling of the instances).</p>
<p>In general <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> is meant to be used after the deployment (after running <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">deploy</span></code>) to notify
the orchestrator about some changes after the deployment.
According to these changes (metrics) that can be specified in the notification file, the orchestrator can the
execute the desired actions.
In other words, <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> introduces a use case for TOSCA policies and their TOSCA triggers as it
enables running TOSCA policy trigger actions (these are basically just pointing to TOSCA interface operations
from TOSCA nodes).
Notification process is invoked on every node similar to deploy or undeploy workflows.</p>
<p>As mentioned above the commands should be used after the deployment but this is not the limit as it can also be
used during other stages of orchestration (at the beginning, before deployment, after undeployment and so on).
The orchestrator will warn users in these non-standard scenarios because the consequences of notify can be
crucial.</p>
<p>For the CLI command, there is one mandatory positional argument called <code class="docutils literal notranslate"><span class="pre">--trigger/-t</span></code> (you can also use the
<code class="docutils literal notranslate"><span class="pre">--event/-e</span></code> alias for this option), which stands for trigger or event name.
So, the CLI command cannot be invoked just with <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> and this is because you probably won’t need to
use all policy triggers, but just one or two, which you can specify with by trigger’s full name or its event
using <code class="docutils literal notranslate"><span class="pre">--trigger/-t</span></code> option.
It is also recommended that you use the <code class="docutils literal notranslate"><span class="pre">--notification/-n</span></code> switch for the path to the notification file
(usually a JSON file) that includes changes (e.g., metrics from monitoring tool) that will be exposed to TOSCA
interfaces as <code class="docutils literal notranslate"><span class="pre">notification</span></code> variable (for example in Ansible playbooks you can use Jinja2
<code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">notification</span> <span class="pre">}}</span></code> template to retrieve and parse the notification file contents).</p>
</div><div aria-labelledby="tab-9-9-2" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-2" name="9-2" role="tabpanel" tabindex="0"><p>With <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">notify</span></code> and by empowering the orchestrator with the practical usage of TOSCA policies and
triggers we wanted to enable scaling and other similar use cases that are based on policies and triggers.
Many applications and services (e.g., AWS Lambda, Docker containers, Kubernetes solutions etc.) that are
deployed with xOpera orchestrator often include the configuration of monitoring tool (e.g., Prometheus) that is
able to collect certain metrics like CPU load or memory usage.
We wanted to ensure scaling of the solutions when certain limits (from TOSCA policies) are reached (like too
high CPU usage).
By running opera notify the scaling scripts (e.g Ansible playbooks) are invoked and scaling can be performed
(the metrics from monitoring tool can also be provided as a notification file).</p>
<p>Follow the next CLI instructions and results for the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/misc/scaling">scaling</a> example.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> misc/scaling
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/scaling$ opera deploy service.yaml</span>
<span class="go">[Worker_0]   Deploying aws_lambda_0</span>
<span class="go">[Worker_0]     Executing create on aws_lambda_0</span>
<span class="go">[Worker_0]   Deployment of aws_lambda_0 complete</span>
<span class="go">[Worker_0]   Deploying configure_monitoring_0</span>
<span class="go">[Worker_0]     Executing configure on configure_monitoring_0</span>
<span class="go">[Worker_0]   Deployment of configure_monitoring_0 complete</span>

<span class="gp"># </span>scale down by calling scale_down_trigger event with notification_scale_down.json notification file
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/scaling$ opera notify -e scale_down_trigger -n files/notification_scale_down.json</span>
</span><span class="go">[Worker_0]   Notifying aws_lambda_0</span>
<span class="go">[Worker_0]    Calling trigger radon.triggers.scaling.ScaleDown with event scale_down_trigger</span>
<span class="go">[Worker_0]     Executing scale_down on aws_lambda_0</span>
<span class="go">[Worker_0]    Calling trigger actions with event scale_down_trigger complete</span>
<span class="go">[Worker_0]   Notification on aws_lambda_0 complete</span>
<span class="go">[Worker_0]   Notifying configure_monitoring_0</span>
<span class="go">[Worker_0]   Notification on configure_monitoring_0 complete</span>

<span class="gp"># </span>scale up by calling scale_up_trigger event with notification_scale_up.json notification file
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">misc/scaling$ opera notify -e scale_up_trigger -n files/notification_scale_up.json</span>
</span><span class="go">[Worker_0]   Notifying aws_lambda_0</span>
<span class="go">[Worker_0]    Calling trigger radon.triggers.scaling.ScaleUp with event scale_up_trigger</span>
<span class="go">[Worker_0]     Executing scale_up on aws_lambda_0</span>
<span class="go">[Worker_0]    Calling trigger actions with event scale_up_trigger complete</span>
<span class="go">[Worker_0]   Notification on aws_lambda_0 complete</span>
<span class="go">[Worker_0]   Notifying configure_monitoring_0</span>
<span class="go">[Worker_0]   Notification on configure_monitoring_0 complete</span>
</pre></div>
</div>
<p>You can also try to deploy the <a class="reference external" href="https://github.com/xlab-si/xopera-examples/tree/master/tosca/policy-triggers">policy-triggers</a> example with the CLI instructions below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">cd</span> tosca/policy-triggers
<span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/policy-triggers$ opera deploy service.yaml</span>
<span class="go">[Worker_0]   Deploying workstation_0</span>
<span class="go">[Worker_0]   Deployment of workstation_0 complete</span>
<span class="go">[Worker_0]   Deploying openstack_vm_0</span>
<span class="go">[Worker_0]     Executing create on openstack_vm_0</span>
<span class="go">[Worker_0]   Deployment of openstack_vm_0 complete</span>

<span class="gp"># </span>invoke TOSCA policy scale down trigger interface operations with opera notify
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/policy-triggers$ opera notify -t radon.triggers.scaling.ScaleDown</span>
</span><span class="go">[Worker_0]   Notifying workstation_0</span>
<span class="go">[Worker_0]   Notification on workstation_0 complete</span>
<span class="go">[Worker_0]   Notifying openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger radon.triggers.scaling.ScaleDown with event scale_down_trigger</span>
<span class="go">[Worker_0]     Executing scale_down on openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger actions with event scale_down_trigger complete</span>
<span class="go">[Worker_0]   Notification on openstack_vm_0 complete</span>

<span class="gp"># </span>invoke TOSCA policy scale up trigger interface operations with opera notify
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/policy-triggers$ opera notify -t radon.triggers.scaling.ScaleUp</span>
</span><span class="go">[Worker_0]   Notifying workstation_0</span>
<span class="go">[Worker_0]   Notification on workstation_0 complete</span>
<span class="go">[Worker_0]   Notifying openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger radon.triggers.scaling.ScaleUp with event scale_up_trigger</span>
<span class="go">[Worker_0]     Executing scale_up on openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger actions with event scale_up_trigger complete</span>
<span class="go">[Worker_0]   Notification on openstack_vm_0 complete</span>

<span class="gp"># </span>invoke TOSCA policy auto-scale trigger interface operations with opera notify
<span class="hll"><span class="gp gp-VirtualEnv">(venv)</span> <span class="go">tosca/policy-triggers$ opera notify -t radon.triggers.scaling.AutoScale</span>
</span><span class="go">[Worker_0]   Notifying workstation_0</span>
<span class="go">[Worker_0]   Notification on workstation_0 complete</span>
<span class="go">[Worker_0]   Notifying openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger radon.triggers.scaling.AutoScale with event auto_scale_trigger</span>
<span class="go">[Worker_0]     Executing retrieve_info on openstack_vm_0</span>
<span class="go">[Worker_0]     Executing autoscale on openstack_vm_0</span>
<span class="go">[Worker_0]    Calling trigger actions with event auto_scale_trigger complete</span>
<span class="go">[Worker_0]   Notification on openstack_vm_0 complete</span>
</pre></div>
</div>
</div></div>
<hr class="docutils" />
</div>
</div>
<div class="section" id="secrets-and-environment-variables">
<span id="cli-secrets-and-environment-variables"></span><h2>Secrets and Environment variables<a class="headerlink" href="#secrets-and-environment-variables" title="Permalink to this headline"></a></h2>
<p>You can use the following environment variables:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 34%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment variable</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPERA_SSH_USER</span></code></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Username for the Ansible ssh</div>
<div class="line">connection to a remote VM</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ubuntu</span></code></div>
<div class="line">(default is <code class="docutils literal notranslate"><span class="pre">centos</span></code>)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPERA_SSH_IDENTITY_FILE</span></code></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Path to the file containing</div>
<div class="line">your private ssh key that</div>
<div class="line">will be used for a</div>
<div class="line">connection to a remote VM</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">~/.ssh/id_ed25519</span></code></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPERA_SSH_HOST_KEY_CHECKING</span></code></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Disable Ansible host key</div>
<div class="line">checking (not recommended)</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">false</span></code> or <code class="docutils literal notranslate"><span class="pre">f</span></code></div>
<div class="line">(not case sensitive)</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Be very careful with your orchestration secrets (such as SSH private keys, cloud credentials, passwords and so on)
that are stored as opera inputs.
To avoid exposing them don’t share the inputs file and the created opera storage folder with anyone.</p>
</div>
</div>
<div class="section" id="shell-completion">
<span id="cli-shell-completion"></span><h2>Shell completion<a class="headerlink" href="#shell-completion" title="Permalink to this headline"></a></h2>
<p>For easier usage of the CLI tool <code class="docutils literal notranslate"><span class="pre">opera</span></code> enables tab completion for all CLI commands and arguments.
We use <a class="reference external" href="https://github.com/iterative/shtab">shtab</a> in our code to generate a shell completion script.
We don’t have a separate command to do that since but rather a global optional argument that will print out the
completion script for the main parser.
This flag is called <code class="docutils literal notranslate"><span class="pre">--shell-completion/-s</span></code> and it receives a shell type to generate completion for.
Shtab currently supports <cite>bash</cite> and <cite>zsh</cite> so those are the options.
So, after running <code class="docutils literal notranslate"><span class="pre">opera</span> <span class="pre">-s</span> <span class="pre">bash|zsh</span></code> the generated tab completion script will be printed out.
To activate it you must source the contents which can be done with <code class="docutils literal notranslate"><span class="pre">eval</span> <span class="pre">&quot;$(opera</span> <span class="pre">-s</span> <span class="pre">bash)&quot;</span></code> or you can save it to a
file and then source it.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>print out completion script <span class="k">for</span> bash shell
<span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span>opera -s bash
<span class="gp">#</span>!/usr/bin/env bash
<span class="gp"># </span>AUTOMATCALLY GENERATED by <span class="sb">`</span>shtab<span class="sb">`</span>

<span class="go">_shtab_opera_subparsers=(&#39;deploy&#39; &#39;diff&#39; &#39;info&#39; &#39;notify&#39; &#39;outputs&#39; &#39;package&#39; &#39;undeploy&#39; &#39;unpackage&#39; &#39;update&#39; &#39;validate&#39;)</span>

<span class="go">_shtab_opera_option_strings=(&#39;-h&#39; &#39;--help&#39; &#39;-s&#39; &#39;--shell-completion&#39; &#39;--version&#39; &#39;-v&#39;)</span>
<span class="go">_shtab_opera_deploy_option_strings=(&#39;-h&#39; &#39;--help&#39; &#39;--instance-path&#39; &#39;-p&#39; &#39;--inputs&#39; &#39;-i&#39; &#39;--workers&#39; &#39;-w&#39; &#39;--resume&#39; &#39;-r&#39; &#39;--clean-state&#39; &#39;-c&#39; &#39;--force&#39; &#39;-f&#39; &#39;--verbose&#39; &#39;-v&#39;)</span>
<span class="go">...</span>

<span class="gp"># </span>print out completion script <span class="k">for</span> zsh shell
<span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span>opera -s zsh
<span class="gp">#</span>compdef opera

<span class="gp"># </span>AUTOMATCALLY GENERATED by <span class="sb">`</span>shtab<span class="sb">`</span>

<span class="go">_shtab_opera_options_=(</span>
<span class="go">  &quot;(- :)&quot;{-h,--help}&quot;[show this help message and exit]&quot;</span>
<span class="go">  {-s,--shell-completion}&quot;[Generate tab completion script for your shell]:shell_completion:(bash zsh)&quot;</span>
<span class="go">  {--version,-v}&quot;[Get current opera package version]:version:&quot;</span>
<span class="go">)</span>

<span class="go">_shtab_opera_commands_() {</span>
<span class="go">  local _commands=(</span>
<span class="go">    &quot;deploy:&quot;</span>
<span class="go">    &quot;diff:&quot;</span>
<span class="go">    &quot;info:&quot;</span>
<span class="go">    &quot;notify:&quot;</span>
<span class="go">    &quot;outputs:&quot;</span>
<span class="go">    &quot;package:&quot;</span>
<span class="go">    &quot;undeploy:&quot;</span>
<span class="go">    &quot;unpackage:&quot;</span>
<span class="go">    &quot;update:&quot;</span>
<span class="go">    &quot;validate:&quot;</span>
<span class="go">  )</span>
<span class="go">...</span>

<span class="gp"># </span>activate completion <span class="k">for</span> bash directly
<span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>opera -s bash<span class="k">)</span><span class="s2">&quot;</span>

<span class="gp"># </span>activate completion <span class="k">for</span> zsh directly
<span class="gp gp-VirtualEnv">(venv)</span> <span class="gp">$ </span><span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>opera -s zsh<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="troubleshooting">
<span id="cli-troubleshooting"></span><h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline"></a></h2>
<p>Every CLI command is equipped with <code class="docutils literal notranslate"><span class="pre">--help/-h</span></code> switch that displays the information about it and its arguments, and
with <code class="docutils literal notranslate"><span class="pre">--verbose/-v</span></code> switch which turns on debug mode and prints out the orchestration parameters and the results from
the executed Ansible playbooks.
Consider using the two switches if you face any problems.
If the issue persists please have a look at the existing <a class="reference external" href="https://github.com/xlab-si/xopera-opera/issues">opera issues</a> or open a new one yourself.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01-intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="03-api.html" class="btn btn-neutral float-right" title="xOpera API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, XLAB d.o.o., xOpera team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>